generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

/// =========================
/// USERS TABLE
/// =========================
model users {
  id            BigInt     @id @default(autoincrement())
  email         String?     @db.Text
  password_hash String?     @db.Text
  full_name     String?     @db.Text
  created_at    DateTime?   @db.Timestamptz(6)
  updated_at    DateTime?   @db.Timestamptz(6)

  // Relations
  holdings      holdings[]
  orders        orders[]
  watchlists    watchlists[]

  @@map("users") // Maps Prisma model â†’ Supabase table
}

/// =========================
/// HOLDINGS TABLE
/// =========================
model holdings {
  id         BigInt   @map("id")
  user_id    BigInt
  symbol     String?  @db.Text
  quantity   BigInt?  
  avg_cost   Float?   @db.DoublePrecision
  created_at DateTime? @db.Timestamptz(6)

  // Composite primary key
  @@id([id, user_id])

  // Relations
  user users @relation(fields: [user_id], references: [id])

  @@map("holdings")
}

/// =========================
/// ORDERS TABLE
/// =========================
model orders {
  id         BigInt   @map("id")
  user_id    BigInt
  symbol     String?  @db.Text
  type       String?  @db.Text
  quantity   BigInt?
  price      Float?   @db.DoublePrecision
  status     String?  @db.Text
  created_at DateTime? @db.Timestamptz(6)

  // Composite primary key
  @@id([id, user_id])

  // Relations
  user users @relation(fields: [user_id], references: [id])

  @@map("orders")
}

/// =========================
/// WATCHLIST TABLE
/// =========================
model watchlists {
  id         BigInt   @map("id")
  user_id    BigInt
  symbol     String?  @db.Text
  created_at DateTime? @db.Timestamptz(6)

  // Composite primary key
  @@id([id, user_id])

  // Relations
  user users @relation(fields: [user_id], references: [id])

  @@map("watchlists")
}
